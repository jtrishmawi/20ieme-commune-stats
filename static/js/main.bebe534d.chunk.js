(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{176:function(e,t,n){e.exports=n(353)},353:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(12),o=n.n(c),l=n(151),u=n.n(l),i=n(5),s=n.n(i),m=n(104),f=n(24),p=n(4),d=n(32),E=n.n(d),b=n(36),h=n(53),O=n(357),v={results:[],sectors:[],offices:[],table:[]},j=function(e,t){switch(t.type){case"LOAD":return t.data;default:return e}},_=function(){var e=Object(h.a)(E.a.mark((function e(){var t,n,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("/20ieme-commune-stats","/data/secteurs-des-bureaux-de-vote.geojson"));case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,a=n.features.filter((function(e){return 20===e.properties.arrondissement})),e.abrupt("return",Object(b.a)({},n,{features:a}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(h.a)(E.a.mark((function e(){var t,n,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("/20ieme-commune-stats","/data/bureaux-de-votes.geojson"));case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,a=n.features.filter((function(e){return"75020"===e.properties.cp})),e.abrupt("return",Object(b.a)({},n,{features:a}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(h.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("/20ieme-commune-stats","/data/resultats.json"));case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(e,t){var n=e.features;return t.map((function(e){var t=n.find((function(t){return Number(t.properties.num_bv)===e.num_bv})),a="".concat(t.properties.lib," - ").concat(t.properties.adresse),r=1===e.tour?"1er Tour":"2i\xe8me Tour";return Object(b.a)({},e,{adresse:a,tour:r})}))},C=Object(a.createContext)(),y=function(){return Object(a.useContext)(C)},N=n(356),T=n(359),P=n(358),R=n(47),M=n(42),k=n(2),A=n(171),D=n(21);function L(){var e=Object(D.a)(["\ntext-align: center;\n\n  small {\n    display: block;\n  }\n"]);return L=function(){return e},e}function S(){var e=Object(D.a)(["\n  width: 100%;\n\n  th:last-child,\n  td:last-child {\n    text-align: center;\n  }\n"]);return S=function(){return e},e}function I(){var e=Object(D.a)(["\n  display: flex;\n  list-style: none;\n  justify-content: space-around;\n  padding: 0;\n"]);return I=function(){return e},e}function z(){var e=Object(D.a)(["\n  height: 200px;\n"]);return z=function(){return e},e}function U(){var e=Object(D.a)(["\n  width: ",";\n"]);return U=function(){return e},e}var V=k.default.div(U(),(function(e){return e.theme.popup.width})),F=k.default.div(z()),B=k.default.ul(I()),H=k.default.table(S()),J=k.default.h3(L()),W=function(e){var t=e.casted,n=e.white,c=e.absentions,o=Object(a.useState)([]),l=Object(p.a)(o,2),u=l[0],i=l[1];return Object(a.useEffect)((function(){i([{id:"Exprim\xe9s",label:"Exprim\xe9s",value:t},{id:"Blancs",label:"Blancs",value:n},{id:"Abstentions",label:"Abstentions",value:c}])}),[t,n,c]),r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null,r.a.createElement(A.a,{data:u,margin:{top:0,right:0,bottom:28,left:0},startAngle:-90,endAngle:90,fit:!0,innerRadius:.5,padAngle:1,cornerRadius:3,colors:{scheme:"paired"},borderWidth:1,enableRadialLabels:!1,slicesLabelsSkipAngle:10,slicesLabelsTextColor:"#333333",animate:!0,motionStiffness:90,motionDamping:15,legends:[{anchor:"bottom",direction:"row",translateY:28,itemWidth:100,itemHeight:18,itemTextColor:"#999",symbolSize:18,symbolShape:"circle",effects:[{on:"hover",style:{itemTextColor:"#000"}}]}]})))},G={popup:{width:"300px"}},Y=(n(345),function(e){var t=e.office,n=e.data,c=Object(a.useState)([]),o=Object(p.a)(c,2),l=o[0],u=o[1],i=Object(a.useState)([]),s=Object(p.a)(i,2),m=s[0],f=s[1],d=Object(a.useState)(0),E=Object(p.a)(d,2),b=E[0],h=E[1],O=Object(a.useState)(0),v=Object(p.a)(O,2),j=v[0],_=v[1],g=Object(a.useState)(0),x=Object(p.a)(g,2),w=x[0],C=x[1];return Object(a.useEffect)((function(){var e=[],t=[];n.forEach((function(n,a){0===a&&(h(n.exprimes),_(n.votants-n.exprimes),C(n.inscrits-n.votants)),1===n.tour?e=[n].concat(Object(R.a)(e)):t=[n].concat(Object(R.a)(t))})),u(e.sort((function(e,t){return t.voix-e.voix}))),f(t.sort((function(e,t){return t.voix-e.voix})))}),[n]),r.a.createElement(k.ThemeProvider,{theme:G},r.a.createElement(V,null,r.a.createElement(J,null,t.lib,r.a.createElement("small",null,t.adresse)),r.a.createElement(W,{casted:b,white:j,absentions:w}),r.a.createElement(B,null,r.a.createElement("li",null,"Exprim\xe9s: ",b),r.a.createElement("li",null,"Blancs: ",j),r.a.createElement("li",null,"Abstentions: ",w)),r.a.createElement(M.d,null,r.a.createElement(M.b,null,r.a.createElement(M.a,null,"1er Tour"),r.a.createElement(M.a,null,"2i\xe8me Tour")),r.a.createElement(M.c,null,r.a.createElement(H,null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"T\xeate de liste"),r.a.createElement("th",null,"Parti"),r.a.createElement("th",null,"Nbre de Voix"))),r.a.createElement("tbody",null,l.map((function(e){return r.a.createElement("tr",{key:e.tete_de_liste},r.a.createElement("td",null,e.tete_de_liste),r.a.createElement("td",null,e.code_nuance),r.a.createElement("td",null,e.voix))}))))),r.a.createElement(M.c,null,r.a.createElement(H,null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"T\xeate de liste"),r.a.createElement("th",null,"Parti"),r.a.createElement("th",null,"Nbre de Voix"))),r.a.createElement("tbody",null,m.map((function(e){return r.a.createElement("tr",{key:e.tete_de_liste},r.a.createElement("td",null,e.tete_de_liste),r.a.createElement("td",null,e.code_nuance),r.a.createElement("td",null,e.voix))}))))))))}),q=s.a.Popup.extend({initialize:function(e,t){s.a.Popup.prototype.initialize.call(this,e,t),this.options.reactElement&&r.a.isValidElement(this.options.reactElement)?(this._reactMode="REACT_MODE_ELEMENT",this._reactElement=this.options.reactElement):this.options.reactComponent?(this._reactMode="REACT_MODE_COMPONENT",this._reactComponent=this.options.reactComponent,this._reactComponentProps=s.a.Util.extend({leafletLayer:this._source},this.options.reactComponentProps)):this._reactMode="REACT_MODE_NONE"},onRemove:function(e){this._container.style.transition="none",o.a.unmountComponentAtNode(this._contentNode),s.a.Popup.prototype.onRemove.call(this,e)},getContent:function(){if("REACT_MODE_NONE"!==this._reactMode)throw new Error("ReactLeafletPopup: can't get content of a react-rendered popup.");return s.a.Popup.prototype.getContent.call(this)},setContent:function(e){switch(this._reactMode){case"REACT_MODE_NONE":return s.a.Popup.prototype.setContent.call(this,e);case"REACT_MODE_ELEMENT":if(!r.a.isValidElement(e))throw new Error("ReactLeafletPopup: Invalid content for ReactElement mode.");return this._reactElement=e,this.update(),this;case"REACT_MODE_COMPONENT":if("object"===typeof e)throw new Error("ReactLeafletPopup: Invalid content for ReactComponent mode.");return this._reactComponentProps=s.a.Util.extend({leafletLayer:this._source},e),this.update(),this;default:throw new Error("ReactLeafletPopup: Invalid content for ReactComponent mode.")}},setData:function(e){return this.setContent(e)},_updateContent:function(){var e=this;switch(this._reactMode){case"REACT_MODE_NONE":return s.a.Popup.prototype._updateContent.call(this);case"REACT_MODE_ELEMENT":return o.a.render(this._reactElement,this._contentNode,(function(){e.fire("react-rendered")})),this;case"REACT_MODE_COMPONENT":var t=r.a.createElement(this._reactComponent,this._reactComponentProps);return o.a.render(t,this._contentNode,(function(){e.fire("react-rendered")})),this;default:throw new Error("ReactLeafletPopup: Error: unknown react rendering mode")}}}),K=function(e){var t=e.offices,n=e.results;return r.a.createElement(P.a,{data:t,onEachFeature:function(e,t){var a=e.properties,r=n.filter((function(e){return e.num_bv===Number(a.num_bv)}));t.bindPopup(new q({reactComponent:Y,reactComponentProps:{office:a,data:r}}))}})},Q=function(e){var t=e.sectors;return r.a.createElement(P.a,{data:t,style:function(e){return{color:"hsla(".concat((e.properties.num_bv+20)%100/100*360,", 100%, 50%, 1)")}}})},X=function(){var e=y(),t=Object(p.a)(e,1)[0],n=t.results,a=t.sectors,c=t.offices;return r.a.createElement(N.a,{center:{lat:48.8649161,lon:2.3984708},zoom:14,style:{width:"100%",height:"100%"}},r.a.createElement(T.a,{url:"https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png",attribution:'\xa9 Openstreetmap France | \xa9 <a href="https://www.openstreetmap.org/copyright'}),r.a.createElement(K,{offices:c,results:n}),r.a.createElement(Q,{sectors:a}))},Z=n(46),$=n(6),ee=n(164),te=n.n(ee),ne=n(360),ae=n(165),re=n.n(ae),ce=[{name:"T\xeate de liste",selector:"tete_de_liste",sortable:!0,searchable:!0,grow:2},{name:"Parti",selector:"code_nuance",searchable:!0,sortable:!0},{name:"Tour",selector:"tour",searchable:!0,sortable:!0},{name:"Voix",selector:"voix",sortable:!0},{name:"Inscrits",selector:"inscrits",hide:"md"},{name:"Votants",selector:"votants",hide:"md"},{name:"Exprim\xe9s",selector:"exprimes",hide:"md"},{name:"Adresse",selector:"adresse",searchable:!0,sortable:!0,grow:3,hide:"sm"}],oe=Object(a.memo)((function(){var e=y(),t=Object(p.a)(e,1)[0].table,n=Object(a.useState)({}),c=Object(p.a)(n,2),o=c[0],l=c[1],u=Object(a.useState)(t),i=Object(p.a)(u,2),s=i[0],m=i[1],f=Object(a.useMemo)((function(){return ce.filter((function(e){return e.searchable})).map((function(e){return{selector:e.selector,name:e.name}}))}),[]);Object(a.useEffect)((function(){l((function(e){return f.reduce((function(e,t){var n=t.selector;return Object(b.a)({},e,{},Object(Z.a)({},n,""))}),e)}))}),[f]);var d=Object(a.useMemo)((function(){return r.a.createElement($.c,null,r.a.createElement($.d,{inline:!0,className:"justify-content-between"},f.map((function(e){var t=e.selector,n=e.name,a=s.reduce((function(e,n){return e.add(n[t])}),new Set);return r.a.createElement($.e,{key:t,className:"mr-2"},r.a.createElement($.g,{size:"sm"},r.a.createElement($.f,{type:"select",name:t,value:o[t],onChange:function(e){return l((function(n){return Object(b.a)({},n,{},Object(Z.a)({},t,e.target.value))}))}},r.a.createElement($.o,{value:""},n),Object(R.a)(a).map((function(e){return r.a.createElement($.o,{key:e,value:e},e)}))),r.a.createElement($.h,{color:"danger",groupClassName:"input-group-prepend",onClick:function(e){return l((function(e){return Object(b.a)({},e,{},Object(Z.a)({},t,""))}))}},"\u2717")))}))))}),[o,f,s]);return Object(ne.a)((function(){if(""===Object.values(o).join(""))m(t);else{var e=re.a.apply(void 0,Object(R.a)(Object.entries(o).filter((function(e){return""!==Object(p.a)(e,2)[1]})).map((function(e){var n=Object(p.a)(e,2),a=n[0],r=n[1];return t.filter((function(e){return e[a]===r}))}))));m(e)}}),350,[o]),r.a.createElement(te.a,{title:"Resultats par bureau de vote",columns:ce,data:s,dense:!0,pagination:!0,subHeader:!0,subHeaderComponent:d})}));function le(){var e=Object(D.a)(["\n  && { \n    height: calc(100vh - 56px);\n    padding: 0;\n  }\n"]);return le=function(){return e},e}var ue=Object(k.default)($.c)(le());function ie(){var e=Object(D.a)(['\n  display: inline-block;\n  width: 64px;\n  height: 64px;\n\n  &:after {\n    content: " ";\n    display: block;\n    width: 46px;\n    height: 46px;\n    margin: 1px;\n    border-radius: 50%;\n    border: 5px solid #000;\n    border-color: #000 transparent #000 transparent;\n    animation: '," 1.2s linear infinite;\n  }\n"]);return ie=function(){return e},e}function se(){var e=Object(D.a)(["\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n"]);return se=function(){return e},e}function me(){var e=Object(D.a)(["\n  height: 100vh;\n  width: 100vw;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: #fff;\n"]);return me=function(){return e},e}var fe=k.default.div(me()),pe=Object(k.keyframes)(se()),de=k.default.div(ie(),pe),Ee=function(){return r.a.createElement(fe,null,r.a.createElement(de,null))},be=n(72),he=function(e){return r.a.createElement($.m,Object.assign({tag:$.a},e))},Oe=function(){var e=Object(a.useState)(!1),t=Object(p.a)(e,2),n=t[0],c=t[1];return r.a.createElement($.l,{color:"faded",light:!0,full:!0,toggleable:"sm"},r.a.createElement($.c,null,r.a.createElement("div",{className:"d-flex justify-content-between"},r.a.createElement(be.a,{tag:he,waitChunk:!0,to:"/"},"Municipales 2020"),r.a.createElement($.n,{onClick:function(){return c(!n)}})),r.a.createElement($.b,{navbar:!0,isOpen:n},r.a.createElement($.i,{navbar:!0,className:"mr-auto"},r.a.createElement($.j,null,r.a.createElement(be.a,{tag:$.k,waitChunk:!0,to:"/"},"Carte")),r.a.createElement($.j,null,r.a.createElement(be.a,{tag:$.k,waitChunk:!0,to:"/tableau"},"Tableau"))))))};var ve,je=(ve=function(e){return e.loading?r.a.createElement(Ee,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(Oe,null),r.a.createElement(ue,{fluid:!0},r.a.createElement(f.d,null,r.a.createElement(f.b,{exact:!0,path:"/"},r.a.createElement(X,null)),r.a.createElement(f.b,{path:"/tableau"},r.a.createElement(oe,null)))))))},function(e){var t=Object(a.useReducer)(j,v),n=Object(p.a)(t,2),c=n[0],o=n[1],l=Object(O.a)(Object(h.a)(E.a.mark((function e(){var t,n,a,r,c,l;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([_(),g(),x()]);case 2:t=e.sent,n=Object(p.a)(t,3),a=n[0],r=n[1],c=n[2],l=w(r,c),o({type:"LOAD",data:{sectors:a,offices:r,results:c,table:l}});case 9:case"end":return e.stop()}}),e)}))),[]),u=l.loading,i=l.error;return r.a.createElement(C.Provider,{value:[c,o]},r.a.createElement(ve,{props:e,loading:u,error:i}))});n(349);delete s.a.Icon.Default.prototype._getIconUrl,s.a.Icon.Default.mergeOptions({iconRetinaUrl:n(350),iconUrl:n(351),shadowUrl:n(352)}),o.a.render(r.a.createElement(u.a,{reset:!0,injectGlobal:!0,theme:G},r.a.createElement(je,null)),document.getElementById("root"))}},[[176,1,2]]]);
//# sourceMappingURL=main.bebe534d.chunk.js.map